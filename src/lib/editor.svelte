<style lang="scss">  $prefix: '.zero-mde';  #{$prefix} {    height: 300px;    border: 1px solid #e1e4e8;    :global(*) {      box-sizing: border-box;    }    &-body {      height: calc(100% - 58px);      display: flex;      #{$prefix}-editor {        height: 100%;        flex: 1;        max-width: 800px;        margin: 0 auto;        width: 0;      }      #{$prefix}-preview {        flex: 1;        overflow-y: auto;        background: white;      }      #{$prefix}-sidebar {        width: 280px;        overflow: auto;        border-left: 1px solid #e1e4e8;        padding: 0 16px;        :global(ul) {          padding-left: 0;          color: #959da5;        }      }    }  }</style><script lang="ts">    import {monaco} from './customMonaco.ts'    import {onDestroy, onMount, tick} from 'svelte'    import Viewer from './viewer.svelte'    import Toolbar from './toolbar.svelte'    import Status from './status.svelte'    import Sidebar from "./sidebar.svelte"    import type {IStandaloneCodeEditor} from './editor.ts'    import {createEditorUtils} from './editor.ts'    import editorWorker from "monaco-editor/esm/vs/editor/editor.worker?worker";    export let value: string // 接收值    export let uploadImages // 上传图片方法    let container: HTMLElement // 编辑器区域    let editorContainer: HTMLElement // 编辑区域    let monacoInstance: IStandaloneCodeEditor // 编辑器实例    let editorValue = value || '' // 当前编辑器文本    let showMode = "all" // 显示模式    let wordCount = 0 // 字数    let lineCount = 0 // 行数    let isSyncScroll = false // 是否同步滚动    let isFullscreen = false // 是否全屏    let isInit = false;// 是否初始化    let showSidebar = false;// 显示目录    let headings = [];// 目录    $:styles = (() => {        if (showMode === "all") {            return 'border-right:1px solid #e1e4e8'        }    })()    $: Context = (() => {        const context = {            container,            editor: monacoInstance,            ...createEditorUtils(monacoInstance),        }        return context    })()    // 监听    $:{        if (isInit) {            console.log("showMode变化:", showMode, monacoInstance)            if (showMode === "all") {                if (monacoInstance == null) {                    tick().then(() => {                        initEditor()                    })                }            } else if (showMode === "onlyLeft") {                if (monacoInstance == null) {                    tick().then(() => {                        initEditor()                    })                }            } else if (showMode === "onlyRight") {                monacoInstance.dispose()                monacoInstance = null            }        }    }    // @ts-ignore    self.MonacoEnvironment = {        getWorker() {            return new editorWorker();        },    };    // 更新统计数据    function updateData() {        editorValue = monacoInstance.getValue()        lineCount = monacoInstance.getModel().getLineCount()        wordCount = editorValue.length    }    // 切换同步状态    function handleChangeSync(e: CustomEvent) {        isSyncScroll = e.detail    }    // 回到顶部    function handleScrollTop() {        //TODO:回到顶部功能    }    // 标题列表改变    function handleChangeHeading(e: CustomEvent) {        const list = e.detail as Array<{ depth: number, value: string }>        headings = list    }    // 切换全屏    function handleFullscreen(e: CustomEvent) {        isFullscreen = e.detail as boolean    }    // 展示模式切换    function handleModeChange(e: CustomEvent) {        const mode = e.detail as string        showMode = mode    }    // 显示目录    function handleShowSidebar(e: CustomEvent) {        const isShow = e.detail as boolean        showSidebar = isShow    }    // 初始化编辑器    function initEditor() {        monacoInstance = monaco.editor.create(editorContainer, {            value,            language: 'markdown',            minimap: {                enabled: false, // 是否启用预览图            },            automaticLayout: true, // 自动布局            overviewRulerBorder: false, // 不显示滚动条边框            scrollbar: {                // 滚动条设置                verticalScrollbarSize: 0, // 竖滚动条                horizontalScrollbarSize: 0, // 横滚动条            },        })        monacoInstance.onDidChangeModelContent(() => {            updateData()        })    }    onMount(() => {        initEditor()        updateData()        isInit = true    })    onDestroy(() => {        monacoInstance.dispose()    })</script><div class="zero-mde" bind:this={container}>    <!--    工具栏-->    <Toolbar context={Context} {uploadImages} {isFullscreen} {showMode} {showSidebar} on:fullscreen={handleFullscreen} on:change:mode={handleModeChange} on:update:sidebar={handleShowSidebar}/>    <div class="zero-mde-body">        {#if showMode === "all" || showMode === "onlyLeft"}            <!--        编辑区-->            <div class="zero-mde-editor" bind:this={editorContainer} style={styles}></div>        {/if}        {#if showMode === "all" || showMode === "onlyRight"}            <!--        预览区-->            <div class="zero-mde-preview">                <Viewer value={editorValue} on:change:heading={handleChangeHeading}/>            </div>        {/if}        {#if showSidebar}            <!--        目录-->            <div class="zero-mde-sidebar">                <Sidebar headings={headings}/>            </div>        {/if}    </div>    <Status {lineCount} {wordCount} {isSyncScroll} on:change-sync={handleChangeSync} on:scroll-top={handleScrollTop}/></div>