<style lang="scss">  $prefix: '.zero-mde';  #{$prefix}-toolbar {    height: 34px;    padding: 0 10px;    border-bottom: 1px solid #e1e4e8;    background: #fafbfc;    display: flex;    align-items: center;    &-left {      flex: 1;    }    &-icon {      display: inline-block;      vertical-align: top;      cursor: pointer;      border-radius: 4px;      margin-left: 6px;      margin-right: 6px;      &:hover {        background-color: #e1e4e8;      }      :global(svg) {        display: block;        padding: 4px;        width: 24px;        height: 24px;      }    }  }</style><script lang="ts">    import {icons} from './icons'    import type {ZeroMDEAction} from './types'    import ActionToolbar from './action-toolbar.svelte'    import DropdownToolbar from './dropdown-toolbar.svelte'    import type {EditorContext} from './editor.ts'    import {createEventDispatcher} from "svelte";    export let context: EditorContext    export let uploadImages    export let isFullscreen = false    export let showMode    export let showSidebar    const emit = createEventDispatcher()    const defaultPlugins: ZeroMDEAction[] = [        {            title: '标题',            icon: icons.heading,            handler: {                type: 'dropdown',                actions: [                    ...[                        {                            title: '一级标题',                            icon: icons.h1,                        },                        {                            title: '二级标题',                            icon: icons.h2,                        },                        {                            title: '三级标题',                            icon: icons.h3,                        },                        {                            title: '四级标题',                            icon: icons.h4,                        },                        {                            title: '五级标题',                            icon: icons.h5,                        },                        {                            title: '六级标题',                            icon: icons.h6,                        },                    ].map((it, i) => {                        return {                            ...it,                            handler: {                                type: 'action',                                click() {                                    context.replaceLines((line) => {                                        line = line.trim().replace(/^#*/, '').trim()                                        line = '#'.repeat(i + 1) + ' ' + line                                        return line                                    })                                    context.editor.focus()                                },                            },                        }                    }),                ],            },        },        {            title: '加粗',            icon: icons.bold,            handler: {                type: 'action',                click() {                    context.wrapText('**', '**')                    context.editor.focus()                },            },        },        {            title: '倾斜',            icon: icons.italic,            handler: {                type: 'action',                click() {                    context.wrapText('*', '*')                    context.editor.focus()                },            },        },        // {        //   title: '删除',        //   icon: icons.del,        //   handler: {        //     type: 'action',        //     click() {        //       context.wrapText('~~', '~~')        //     },        //   },        // },        {            title: '引用',            icon: icons.quote,            handler: {                type: 'action',                click() {                    context.replaceLines((str) => {                        return '> ' + str                    })                    context.editor.focus()                },            },        },        {            title: '链接',            icon: icons.link,            handler: {                type: 'action',                click() {                    context.wrapText('[', '](url)')                    context.editor.focus()                },            },        },        {            title: '图片',            icon: icons.image,            handler: uploadImages                ? {                    type: 'action',                    click() {                        context.selectFiles({accept: 'image/*', multiple: true}).then((files) => {                            uploadImages(files).then(imgs => {                                context.appendBlock(imgs.map(({url, alt, title}) => {                                    return `![${alt}](${url}${title ? ` "${title}"` : ''})`                                }).join('\n'))                            })                        })                    },                }                : null,        },        {            title: '代码',            icon: icons.code,            handler: {                type: 'action',                click() {                    context.wrapText('`', '`')                    context.editor.focus()                },            },        },        {            title: '代码块',            icon: icons.codeBlock,            handler: {                type: 'action',                click() {                    context.appendBlock('```js\n\n' + '```')                    context.editor.focus()                },            },        },        {            title: '无序列表',            icon: icons.ol,            handler: {                type: 'action',                click() {                    context.replaceLines((str) => {                        return '- ' + str                    })                    context.editor.focus()                },            },        },        {            title: '有序列表',            icon: icons.ul,            handler: {                type: 'action',                click() {                    context.replaceLines((str) => {                        return '1. ' + str                    })                    context.editor.focus()                },            },        },        {            title: '分割线',            icon: icons.hr,            handler: {                type: 'action',                click() {                    context.replaceLines((line) => {                        return '---'                    })                    context.editor.focus()                },            },        },    ]    $: rightActions = (() => [        {            title: '目录',            icon: icons.toc,            active: showSidebar,            handler: {                type: 'action',                click() {                    emit("update:sidebar", !showSidebar)                },            },        },        {            title: '帮助',            icon: icons.help,            active: false,            handler: {                type: 'action',                click() {                },            },        },        {            title: '仅编辑区',            icon: icons.left,            active: showMode === "onlyLeft",            handler: {                type: 'action',                click() {                    if (showMode !== "onlyLeft") {                        emit("change:mode", "onlyLeft")                    } else {                        emit("change:mode", "all")                    }                },            },        },        {            title: '仅预览区',            icon: icons.right,            active: showMode === "onlyRight",            handler: {                type: 'action',                click() {                    if (showMode !== "onlyRight") {                        emit("change:mode", "onlyRight")                    } else {                        emit("change:mode", "all")                    }                },            },        },        {            title: '全屏',            icon: isFullscreen ? icons.fullscreenOff : icons.fullscreenOn,            handler: {                type: 'action',                click() {                    if (!isFullscreen) {                        context.container.requestFullscreen()                    } else {                        document.exitFullscreen()                    }                    emit("fullscreen", !isFullscreen)                },            },        },    ])()</script><div class="zero-mde-toolbar">    <div class="zero-mde-toolbar-left">        {#each defaultPlugins as plugin}            {#if plugin.handler?.type === 'action'}                <ActionToolbar {plugin}/>            {:else if plugin.handler?.type === 'dropdown'}                <DropdownToolbar {plugin}/>            {/if}        {/each}    </div>    <div class="zero-mde-toolbar-right">        {#each rightActions as plugin}            <ActionToolbar {plugin}/>        {/each}    </div></div>